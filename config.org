#+TITLE: config
#+OPTIONS: toc:4 h:4
#+STARTUP: hideblocks
#+PROPERTY: header-args :results silent :tangle yes

* Ideas and inspiration
https://sam217pa.github.io/2016/09/02/how-to-build-your-own-spacemacs/
* Package Configuration
** Deadgrep
Don't use doom's popups
#+BEGIN_SRC emacs-lisp
(map!
 "C-c s ;" #'deadgrep
 "<f5>" #'deadgrep)
(after! deadgrep
  (set-popup-rule! "^\\*deadgrep" :height 200))
#+END_SRC
** CIDER (Clojure)
#+begin_src emacs-lisp
(after! cider
  (cider-auto-test-mode 1))
#+end_src
* Custom Configuration
** Yank filename relative to project
#+BEGIN_SRC emacs-lisp
(defun yank-buffer-filename-relative ()
  "Copy the current buffer's path to the kill ring."
  (interactive)
  (if-let* ((filename (or buffer-file-name (bound-and-true-p list-buffers-directory))))
    (message (kill-new (abbreviate-file-name (file-relative-name filename (projectile-project-root)))))
    (error "Couldn't find filename in current buffer")))
#+END_SRC
** Add an exec path
#+BEGIN_SRC emacs-lisp
(setenv "PATH" (concat (getenv "PATH") ":/usr/local/bin"))
(setq exec-path (append exec-path '("/usr/local/bin")))
#+END_SRC
* Editor Configuration
** Indents
#+BEGIN_SRC emacs-lisp
(setq-default tab-width 2)
;; (setq-default evil-shift-width 2)
#+END_SRC
** Line Numbering
#+BEGIN_SRC emacs-lisp
;; Set line numbers to be relative
(setq display-line-numbers 'relative)
(setq display-line-numbers-type 'relative)
(setq display-line-numbers-current-absolute t)
;; (global-display-line-numbers-mode t)
#+END_SRC
** Theme
#+BEGIN_SRC emacs-lisp
(if (display-graphic-p)
  (load-theme 'doom-gruvbox t))
#+END_SRC
** Font
#+BEGIN_SRC elisp
  (setq doom-font (font-spec :family "Source Code Pro" :size 18 :weight 'semi-light)
        doom-variable-pitch-font (font-spec :family "Source Code Pro" :size 16))
#+END_SRC
** Menu Bar
Hide the menu bar if it isn't hidden
#+BEGIN_SRC elisp
(menu-bar-mode -1)
(toggle-scroll-bar -1)
(tool-bar-mode -1)
#+END_SRC
** Start in maximized screen
#+BEGIN_SRC elisp
(toggle-frame-maximized)
#+END_SRC
** Suppress cl warnings
#+BEGIN_SRC elisp
(setq byte-compile-warnings '(cl-functions))
#+END_SRC
* NOTES
:properties:
:header-args: :tangle no
:end:
** Error message: "Could not find package X in recipe repositories"
*** https://github.com/hlissner/doom-emacs/issues/2802
#+BEGIN_SRC sh
  # Update MELPA
  cd ~/.emacs.d/.local/straight/repos/melpa
  git pull

  # Clear straight's cache
  rm -f ~/.emacs.d/.local/straight/build-cache.el
  doom sync
#+END_SRC

** Compiled Emacs terminal and other stuff:
https://emacsformacosx.com/tips
** If issue with recursive load
*** From https://github.com/bbatsov/prelude/issues/1134
`(setq load-prefer-newer t)`
